{"version":3,"file":"search.js","sourceRoot":"","sources":["../../play-dl/YouTube/search.ts"],"names":[],"mappings":";;;AAAA,0CAAuC;AACvC,2CAAyE;AAKzE,IAAK,UAIJ;AAJD,WAAK,UAAU;IACX,wCAA0B,CAAA;IAC1B,2CAA6B,CAAA;IAC7B,0CAA4B,CAAA;AAChC,CAAC,EAJI,UAAU,KAAV,UAAU,QAId;AAMD;;;;;GAKG;AACI,KAAK,UAAU,SAAS,CAAC,MAAc,EAAE,UAAgC,EAAE;IAC9E,IAAI,GAAG,GAAG,+CAA+C,GAAG,MAAM,CAAC;IACnE,OAAO,CAAC,IAAI,KAAK,OAAO,CAAC;IACzB,IAAI,GAAG,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE;QAC5B,GAAG,IAAI,MAAM,CAAC;QACd,QAAQ,OAAO,CAAC,IAAI,EAAE;YAClB,KAAK,SAAS;gBACV,GAAG,IAAI,UAAU,CAAC,OAAO,CAAC;gBAC1B,MAAM;YACV,KAAK,UAAU;gBACX,GAAG,IAAI,UAAU,CAAC,QAAQ,CAAC;gBAC3B,MAAM;YACV,KAAK,OAAO;gBACR,GAAG,IAAI,UAAU,CAAC,KAAK,CAAC;gBACxB,MAAM;YACV;gBACI,MAAM,IAAI,KAAK,CAAC,wBAAwB,OAAO,CAAC,IAAI,EAAE,CAAC,CAAC;SAC/D;KACJ;IACD,MAAM,IAAI,GAAG,MAAM,IAAA,iBAAO,EAAC,GAAG,EAAE;QAC5B,OAAO,EAAE;YACL,iBAAiB,EAAE,OAAO,CAAC,QAAQ,IAAI,aAAa;SACvD;KACJ,CAAC,CAAC;IACH,IAAI,IAAI,CAAC,OAAO,CAAC,uEAAuE,CAAC,KAAK,CAAC,CAAC;QAC5F,MAAM,IAAI,KAAK,CAAC,wDAAwD,CAAC,CAAC;IAC9E,OAAO,IAAA,0BAAiB,EAAC,IAAI,EAAE,OAAO,CAAC,CAAC;AAC5C,CAAC;AA3BD,8BA2BC","sourcesContent":["import { request } from './../Request';\r\nimport { ParseSearchInterface, ParseSearchResult } from './utils/parser';\r\nimport { YouTubeVideo } from './classes/Video';\r\nimport { YouTubeChannel } from './classes/Channel';\r\nimport { YouTubePlayList } from './classes/Playlist';\r\n\r\nenum SearchType {\r\n    Video = 'EgIQAQ%253D%253D',\r\n    PlayList = 'EgIQAw%253D%253D',\r\n    Channel = 'EgIQAg%253D%253D'\r\n}\r\n\r\n/**\r\n * Type for YouTube returns\r\n */\r\nexport type YouTube = YouTubeVideo | YouTubeChannel | YouTubePlayList;\r\n/**\r\n * Command to search from YouTube\r\n * @param search The query to search\r\n * @param options limit & type of YouTube search you want.\r\n * @returns YouTube type.\r\n */\r\nexport async function yt_search(search: string, options: ParseSearchInterface = {}): Promise<YouTube[]> {\r\n    let url = 'https://www.youtube.com/results?search_query=' + search;\r\n    options.type ??= 'video';\r\n    if (url.indexOf('&sp=') === -1) {\r\n        url += '&sp=';\r\n        switch (options.type) {\r\n            case 'channel':\r\n                url += SearchType.Channel;\r\n                break;\r\n            case 'playlist':\r\n                url += SearchType.PlayList;\r\n                break;\r\n            case 'video':\r\n                url += SearchType.Video;\r\n                break;\r\n            default:\r\n                throw new Error(`Unknown search type: ${options.type}`);\r\n        }\r\n    }\r\n    const body = await request(url, {\r\n        headers: {\r\n            'accept-language': options.language || 'en-US;q=0.9'\r\n        }\r\n    });\r\n    if (body.indexOf('Our systems have detected unusual traffic from your computer network.') !== -1)\r\n        throw new Error('Captcha page: YouTube has detected that you are a bot!');\r\n    return ParseSearchResult(body, options);\r\n}\r\n"]}